"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const { DynamoDB } = require('aws-sdk');
exports.handler = async function (event) {
    console.log("request:", JSON.stringify(event, undefined, 2));
    if (Math.random() < 0.4) {
        throw new Error("Internal Server Error");
    }
    let bookingID = '';
    if (typeof event.ReserveHotelResult !== 'undefined') {
        bookingID = event.ReserveHotelResult.Payload.booking_id;
    }
    // create AWS SDK clients
    const dynamo = new DynamoDB();
    var params = {
        TableName: process.env.TABLE_NAME,
        Key: {
            'pk': { S: event.trip_id },
            'sk': { S: 'HOTEL#' + bookingID }
        }
    };
    // Call DynamoDB to add the item to the table
    let result = await dynamo.deleteItem(params).promise().catch((error) => {
        throw new Error(error);
    });
    console.log('deleted hotel booking:');
    console.log(result);
    // return status of ok
    return { status: "ok" };
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2FuY2VsSG90ZWwuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJjYW5jZWxIb3RlbC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLE1BQU0sRUFBRSxRQUFRLEVBQUUsR0FBRyxPQUFPLENBQUMsU0FBUyxDQUFDLENBQUM7QUFHeEMsT0FBTyxDQUFDLE9BQU8sR0FBRyxLQUFLLFdBQVUsS0FBUztJQUN4QyxPQUFPLENBQUMsR0FBRyxDQUFDLFVBQVUsRUFBRSxJQUFJLENBQUMsU0FBUyxDQUFDLEtBQUssRUFBRSxTQUFTLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUU3RCxJQUFJLElBQUksQ0FBQyxNQUFNLEVBQUUsR0FBRyxHQUFHLEVBQUU7UUFDdkIsTUFBTSxJQUFJLEtBQUssQ0FBQyx1QkFBdUIsQ0FBQyxDQUFDO0tBQzFDO0lBRUQsSUFBSSxTQUFTLEdBQUcsRUFBRSxDQUFDO0lBQ25CLElBQUksT0FBTyxLQUFLLENBQUMsa0JBQWtCLEtBQUssV0FBVyxFQUFFO1FBQ2pELFNBQVMsR0FBRyxLQUFLLENBQUMsa0JBQWtCLENBQUMsVUFBVSxDQUFDO0tBQ25EO0lBRUQseUJBQXlCO0lBQ3pCLE1BQU0sTUFBTSxHQUFHLElBQUksUUFBUSxFQUFFLENBQUM7SUFFOUIsSUFBSSxNQUFNLEdBQUc7UUFDWCxTQUFTLEVBQUUsT0FBTyxDQUFDLEdBQUcsQ0FBQyxVQUFVO1FBQ2pDLEdBQUcsRUFBRTtZQUNILElBQUksRUFBRyxFQUFDLENBQUMsRUFBRSxLQUFLLENBQUMsT0FBTyxFQUFDO1lBQ3pCLElBQUksRUFBRyxFQUFDLENBQUMsRUFBRSxRQUFRLEdBQUMsU0FBUyxFQUFDO1NBQy9CO0tBQ0YsQ0FBQztJQUVGLDZDQUE2QztJQUM3QyxJQUFJLE1BQU0sR0FBRyxNQUFNLE1BQU0sQ0FBQyxVQUFVLENBQUMsTUFBTSxDQUFDLENBQUMsT0FBTyxFQUFFLENBQUMsS0FBSyxDQUFDLENBQUMsS0FBVSxFQUFFLEVBQUU7UUFDMUUsTUFBTSxJQUFJLEtBQUssQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUN6QixDQUFDLENBQUMsQ0FBQztJQUVILE9BQU8sQ0FBQyxHQUFHLENBQUMsd0JBQXdCLENBQUMsQ0FBQztJQUN0QyxPQUFPLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxDQUFDO0lBRXBCLHNCQUFzQjtJQUN0QixPQUFPLEVBQUMsTUFBTSxFQUFFLElBQUksRUFBQyxDQUFBO0FBQ3ZCLENBQUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IHsgRHluYW1vREIgfSA9IHJlcXVpcmUoJ2F3cy1zZGsnKTtcbmV4cG9ydCB7fTtcblxuZXhwb3J0cy5oYW5kbGVyID0gYXN5bmMgZnVuY3Rpb24oZXZlbnQ6YW55KSB7XG4gIGNvbnNvbGUubG9nKFwicmVxdWVzdDpcIiwgSlNPTi5zdHJpbmdpZnkoZXZlbnQsIHVuZGVmaW5lZCwgMikpO1xuXG4gIGlmIChNYXRoLnJhbmRvbSgpIDwgMC40KSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFwiSW50ZXJuYWwgU2VydmVyIEVycm9yXCIpO1xuICB9XG5cbiAgbGV0IGJvb2tpbmdJRCA9ICcnO1xuICBpZiAodHlwZW9mIGV2ZW50LlJlc2VydmVIb3RlbFJlc3VsdCAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIGJvb2tpbmdJRCA9IGV2ZW50LlJlc2VydmVIb3RlbFJlc3VsdC5ib29raW5nX2lkO1xuICB9XG5cbiAgLy8gY3JlYXRlIEFXUyBTREsgY2xpZW50c1xuICBjb25zdCBkeW5hbW8gPSBuZXcgRHluYW1vREIoKTtcblxuICB2YXIgcGFyYW1zID0ge1xuICAgIFRhYmxlTmFtZTogcHJvY2Vzcy5lbnYuVEFCTEVfTkFNRSxcbiAgICBLZXk6IHtcbiAgICAgICdwaycgOiB7UzogZXZlbnQudHJpcF9pZH0sXG4gICAgICAnc2snIDoge1M6ICdIT1RFTCMnK2Jvb2tpbmdJRH1cbiAgICB9XG4gIH07XG4gIFxuICAvLyBDYWxsIER5bmFtb0RCIHRvIGFkZCB0aGUgaXRlbSB0byB0aGUgdGFibGVcbiAgbGV0IHJlc3VsdCA9IGF3YWl0IGR5bmFtby5kZWxldGVJdGVtKHBhcmFtcykucHJvbWlzZSgpLmNhdGNoKChlcnJvcjogYW55KSA9PiB7XG4gICAgdGhyb3cgbmV3IEVycm9yKGVycm9yKTtcbiAgfSk7XG5cbiAgY29uc29sZS5sb2coJ2RlbGV0ZWQgaG90ZWwgYm9va2luZzonKTtcbiAgY29uc29sZS5sb2cocmVzdWx0KTtcblxuICAvLyByZXR1cm4gc3RhdHVzIG9mIG9rXG4gIHJldHVybiB7c3RhdHVzOiBcIm9rXCJ9XG59OyJdfQ==