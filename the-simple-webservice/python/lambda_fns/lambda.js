"use strict";
const { DynamoDB, Lambda } = require('aws-sdk');
exports.handler = async function (event) {
    console.log("request:", JSON.stringify(event, undefined, 2));
    // create AWS SDK clients
    const dynamo = new DynamoDB();
    // update dynamo entry for "path" with hits++
    await dynamo.updateItem({
        TableName: process.env.HITS_TABLE_NAME,
        Key: { path: { S: event.rawPath } },
        UpdateExpression: 'ADD hits :incr',
        ExpressionAttributeValues: { ':incr': { N: '1' } }
    }).promise();
    console.log('inserted counter for ' + event.rawPath);
    // return response back to upstream caller
    return sendRes(200, 'You have connected with the Lambda!');
};
const sendRes = (status, body) => {
    var response = {
        statusCode: status,
        headers: {
            "Content-Type": "text/html"
        },
        body: body
    };
    return response;
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGFtYmRhLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsibGFtYmRhLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxNQUFNLEVBQUUsUUFBUSxFQUFFLE1BQU0sRUFBRSxHQUFHLE9BQU8sQ0FBQyxTQUFTLENBQUMsQ0FBQztBQUVoRCxPQUFPLENBQUMsT0FBTyxHQUFHLEtBQUssV0FBVSxLQUFTO0lBQ3hDLE9BQU8sQ0FBQyxHQUFHLENBQUMsVUFBVSxFQUFFLElBQUksQ0FBQyxTQUFTLENBQUMsS0FBSyxFQUFFLFNBQVMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBRTdELHlCQUF5QjtJQUN6QixNQUFNLE1BQU0sR0FBRyxJQUFJLFFBQVEsRUFBRSxDQUFDO0lBRTlCLDZDQUE2QztJQUM3QyxNQUFNLE1BQU0sQ0FBQyxVQUFVLENBQUM7UUFDdEIsU0FBUyxFQUFFLE9BQU8sQ0FBQyxHQUFHLENBQUMsZUFBZTtRQUN0QyxHQUFHLEVBQUUsRUFBRSxJQUFJLEVBQUUsRUFBRSxDQUFDLEVBQUUsS0FBSyxDQUFDLElBQUksRUFBRSxFQUFFO1FBQ2hDLGdCQUFnQixFQUFFLGdCQUFnQjtRQUNsQyx5QkFBeUIsRUFBRSxFQUFFLE9BQU8sRUFBRSxFQUFFLENBQUMsRUFBRSxHQUFHLEVBQUUsRUFBRTtLQUNuRCxDQUFDLENBQUMsT0FBTyxFQUFFLENBQUM7SUFFYixPQUFPLENBQUMsR0FBRyxDQUFDLHVCQUF1QixHQUFFLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUVqRCwwQ0FBMEM7SUFDMUMsT0FBTyxPQUFPLENBQUMsR0FBRyxFQUFFLHFDQUFxQyxDQUFDLENBQUM7QUFDN0QsQ0FBQyxDQUFDO0FBRUYsTUFBTSxPQUFPLEdBQUcsQ0FBQyxNQUFhLEVBQUUsSUFBVyxFQUFFLEVBQUU7SUFDN0MsSUFBSSxRQUFRLEdBQUc7UUFDYixVQUFVLEVBQUUsTUFBTTtRQUNsQixPQUFPLEVBQUU7WUFDUCxjQUFjLEVBQUUsV0FBVztTQUM1QjtRQUNELElBQUksRUFBRSxJQUFJO0tBQ1gsQ0FBQztJQUNGLE9BQU8sUUFBUSxDQUFDO0FBQ2xCLENBQUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IHsgRHluYW1vREIsIExhbWJkYSB9ID0gcmVxdWlyZSgnYXdzLXNkaycpO1xyXG5cclxuZXhwb3J0cy5oYW5kbGVyID0gYXN5bmMgZnVuY3Rpb24oZXZlbnQ6YW55KSB7XHJcbiAgY29uc29sZS5sb2coXCJyZXF1ZXN0OlwiLCBKU09OLnN0cmluZ2lmeShldmVudCwgdW5kZWZpbmVkLCAyKSk7XHJcblxyXG4gIC8vIGNyZWF0ZSBBV1MgU0RLIGNsaWVudHNcclxuICBjb25zdCBkeW5hbW8gPSBuZXcgRHluYW1vREIoKTtcclxuXHJcbiAgLy8gdXBkYXRlIGR5bmFtbyBlbnRyeSBmb3IgXCJwYXRoXCIgd2l0aCBoaXRzKytcclxuICBhd2FpdCBkeW5hbW8udXBkYXRlSXRlbSh7XHJcbiAgICBUYWJsZU5hbWU6IHByb2Nlc3MuZW52LkhJVFNfVEFCTEVfTkFNRSxcclxuICAgIEtleTogeyBwYXRoOiB7IFM6IGV2ZW50LnBhdGggfSB9LFxyXG4gICAgVXBkYXRlRXhwcmVzc2lvbjogJ0FERCBoaXRzIDppbmNyJyxcclxuICAgIEV4cHJlc3Npb25BdHRyaWJ1dGVWYWx1ZXM6IHsgJzppbmNyJzogeyBOOiAnMScgfSB9XHJcbiAgfSkucHJvbWlzZSgpO1xyXG5cclxuICBjb25zb2xlLmxvZygnaW5zZXJ0ZWQgY291bnRlciBmb3IgJysgZXZlbnQucGF0aCk7XHJcblxyXG4gIC8vIHJldHVybiByZXNwb25zZSBiYWNrIHRvIHVwc3RyZWFtIGNhbGxlclxyXG4gIHJldHVybiBzZW5kUmVzKDIwMCwgJ1lvdSBoYXZlIGNvbm5lY3RlZCB3aXRoIHRoZSBMYW1iZGEhJyk7XHJcbn07XHJcblxyXG5jb25zdCBzZW5kUmVzID0gKHN0YXR1czpudW1iZXIsIGJvZHk6c3RyaW5nKSA9PiB7XHJcbiAgdmFyIHJlc3BvbnNlID0ge1xyXG4gICAgc3RhdHVzQ29kZTogc3RhdHVzLFxyXG4gICAgaGVhZGVyczoge1xyXG4gICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcInRleHQvaHRtbFwiXHJcbiAgICB9LFxyXG4gICAgYm9keTogYm9keVxyXG4gIH07XHJcbiAgcmV0dXJuIHJlc3BvbnNlO1xyXG59OyJdfQ==