"use strict";
const { DynamoDB, Lambda } = require('aws-sdk');
exports.handler = async function (event) {
    console.log("request:", JSON.stringify(event, undefined, 2));
    // create AWS SDK clients
    const dynamo = new DynamoDB();
    // update dynamo entry for "path" with hits++
    await dynamo.updateItem({
        TableName: process.env.HITS_TABLE_NAME,
        Key: { path: { S: event.path } },
        UpdateExpression: 'ADD hits :incr',
        ExpressionAttributeValues: { ':incr': { N: '1' } }
    }).promise();
    console.log('inserted counter for ' + event.path);
    // return response back to upstream caller
    return sendRes(200, 'You have connected with the Lambda!');
};
const sendRes = (status, body) => {
    var response = {
        statusCode: status,
        headers: {
            "Content-Type": "text/html"
        },
        body: body
    };
    return response;
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGFtYmRhLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsibGFtYmRhLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxNQUFNLEVBQUUsUUFBUSxFQUFFLE1BQU0sRUFBRSxHQUFHLE9BQU8sQ0FBQyxTQUFTLENBQUMsQ0FBQztBQUVoRCxPQUFPLENBQUMsT0FBTyxHQUFHLEtBQUssV0FBVSxLQUFTO0lBQ3hDLE9BQU8sQ0FBQyxHQUFHLENBQUMsVUFBVSxFQUFFLElBQUksQ0FBQyxTQUFTLENBQUMsS0FBSyxFQUFFLFNBQVMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBRTdELHlCQUF5QjtJQUN6QixNQUFNLE1BQU0sR0FBRyxJQUFJLFFBQVEsRUFBRSxDQUFDO0lBRTlCLDZDQUE2QztJQUM3QyxNQUFNLE1BQU0sQ0FBQyxVQUFVLENBQUM7UUFDdEIsU0FBUyxFQUFFLE9BQU8sQ0FBQyxHQUFHLENBQUMsZUFBZTtRQUN0QyxHQUFHLEVBQUUsRUFBRSxJQUFJLEVBQUUsRUFBRSxDQUFDLEVBQUUsS0FBSyxDQUFDLElBQUksRUFBRSxFQUFFO1FBQ2hDLGdCQUFnQixFQUFFLGdCQUFnQjtRQUNsQyx5QkFBeUIsRUFBRSxFQUFFLE9BQU8sRUFBRSxFQUFFLENBQUMsRUFBRSxHQUFHLEVBQUUsRUFBRTtLQUNuRCxDQUFDLENBQUMsT0FBTyxFQUFFLENBQUM7SUFFYixPQUFPLENBQUMsR0FBRyxDQUFDLHVCQUF1QixHQUFFLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUVqRCwwQ0FBMEM7SUFDMUMsT0FBTyxPQUFPLENBQUMsR0FBRyxFQUFFLHFDQUFxQyxDQUFDLENBQUM7QUFDN0QsQ0FBQyxDQUFDO0FBRUYsTUFBTSxPQUFPLEdBQUcsQ0FBQyxNQUFhLEVBQUUsSUFBVyxFQUFFLEVBQUU7SUFDN0MsSUFBSSxRQUFRLEdBQUc7UUFDYixVQUFVLEVBQUUsTUFBTTtRQUNsQixPQUFPLEVBQUU7WUFDUCxjQUFjLEVBQUUsV0FBVztTQUM1QjtRQUNELElBQUksRUFBRSxJQUFJO0tBQ1gsQ0FBQztJQUNGLE9BQU8sUUFBUSxDQUFDO0FBQ2xCLENBQUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IHsgRHluYW1vREIsIExhbWJkYSB9ID0gcmVxdWlyZSgnYXdzLXNkaycpO1xuXG5leHBvcnRzLmhhbmRsZXIgPSBhc3luYyBmdW5jdGlvbihldmVudDphbnkpIHtcbiAgY29uc29sZS5sb2coXCJyZXF1ZXN0OlwiLCBKU09OLnN0cmluZ2lmeShldmVudCwgdW5kZWZpbmVkLCAyKSk7XG5cbiAgLy8gY3JlYXRlIEFXUyBTREsgY2xpZW50c1xuICBjb25zdCBkeW5hbW8gPSBuZXcgRHluYW1vREIoKTtcblxuICAvLyB1cGRhdGUgZHluYW1vIGVudHJ5IGZvciBcInBhdGhcIiB3aXRoIGhpdHMrK1xuICBhd2FpdCBkeW5hbW8udXBkYXRlSXRlbSh7XG4gICAgVGFibGVOYW1lOiBwcm9jZXNzLmVudi5ISVRTX1RBQkxFX05BTUUsXG4gICAgS2V5OiB7IHBhdGg6IHsgUzogZXZlbnQucGF0aCB9IH0sXG4gICAgVXBkYXRlRXhwcmVzc2lvbjogJ0FERCBoaXRzIDppbmNyJyxcbiAgICBFeHByZXNzaW9uQXR0cmlidXRlVmFsdWVzOiB7ICc6aW5jcic6IHsgTjogJzEnIH0gfVxuICB9KS5wcm9taXNlKCk7XG5cbiAgY29uc29sZS5sb2coJ2luc2VydGVkIGNvdW50ZXIgZm9yICcrIGV2ZW50LnBhdGgpO1xuXG4gIC8vIHJldHVybiByZXNwb25zZSBiYWNrIHRvIHVwc3RyZWFtIGNhbGxlclxuICByZXR1cm4gc2VuZFJlcygyMDAsICdZb3UgaGF2ZSBjb25uZWN0ZWQgd2l0aCB0aGUgTGFtYmRhIScpO1xufTtcblxuY29uc3Qgc2VuZFJlcyA9IChzdGF0dXM6bnVtYmVyLCBib2R5OnN0cmluZykgPT4ge1xuICB2YXIgcmVzcG9uc2UgPSB7XG4gICAgc3RhdHVzQ29kZTogc3RhdHVzLFxuICAgIGhlYWRlcnM6IHtcbiAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwidGV4dC9odG1sXCJcbiAgICB9LFxuICAgIGJvZHk6IGJvZHlcbiAgfTtcbiAgcmV0dXJuIHJlc3BvbnNlO1xufTsiXX0=