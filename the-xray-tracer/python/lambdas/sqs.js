"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const AWSXRay = require('aws-xray-sdk');
const AWS = AWSXRay.captureAWS(require('aws-sdk'));
exports.handler = async function (event) {
    const segment = AWSXRay.getSegment(); //returns the facade segment
    const sqsSegment = segment.addNewSubsegment('SQS Logic');
    console.log("request:", JSON.stringify(event, undefined, 2));
    // Create an SQS service object
    var sqs = new AWS.SQS({ apiVersion: '2012-11-05' });
    let path = event.Records[0].Sns.Message;
    var params = {
        DelaySeconds: 1,
        MessageBody: "hello from " + path,
        QueueUrl: process.env.SQS_URL,
    };
    sqsSegment.addAnnotation("message", params.MessageBody);
    sqsSegment.addMetadata("params", params);
    await sqs.sendMessage(params, function (err, data) {
        if (err) {
            console.log("Error", err);
        }
        else {
            console.log("Success", data.MessageId);
        }
    }).promise();
    // return response back to upstream caller
    return { "status": "success" };
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3FzLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsic3FzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQ0EsTUFBTSxPQUFPLEdBQUcsT0FBTyxDQUFDLGNBQWMsQ0FBQyxDQUFDO0FBQ3hDLE1BQU0sR0FBRyxHQUFHLE9BQU8sQ0FBQyxVQUFVLENBQUMsT0FBTyxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUM7QUFFbkQsT0FBTyxDQUFDLE9BQU8sR0FBRyxLQUFLLFdBQVUsS0FBUztJQUN4QyxNQUFNLE9BQU8sR0FBRyxPQUFPLENBQUMsVUFBVSxFQUFFLENBQUMsQ0FBQyw0QkFBNEI7SUFDbEUsTUFBTSxVQUFVLEdBQUcsT0FBTyxDQUFDLGdCQUFnQixDQUFDLFdBQVcsQ0FBQyxDQUFDO0lBQ3pELE9BQU8sQ0FBQyxHQUFHLENBQUMsVUFBVSxFQUFFLElBQUksQ0FBQyxTQUFTLENBQUMsS0FBSyxFQUFFLFNBQVMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBRTdELCtCQUErQjtJQUMvQixJQUFJLEdBQUcsR0FBRyxJQUFJLEdBQUcsQ0FBQyxHQUFHLENBQUMsRUFBQyxVQUFVLEVBQUUsWUFBWSxFQUFDLENBQUMsQ0FBQztJQUNsRCxJQUFJLElBQUksR0FBRyxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUM7SUFFeEMsSUFBSSxNQUFNLEdBQUc7UUFDWCxZQUFZLEVBQUUsQ0FBQztRQUNmLFdBQVcsRUFBRSxhQUFhLEdBQUMsSUFBSTtRQUMvQixRQUFRLEVBQUUsT0FBTyxDQUFDLEdBQUcsQ0FBQyxPQUFPO0tBQzlCLENBQUM7SUFDRixVQUFVLENBQUMsYUFBYSxDQUFDLFNBQVMsRUFBRSxNQUFNLENBQUMsV0FBVyxDQUFDLENBQUM7SUFDeEQsVUFBVSxDQUFDLFdBQVcsQ0FBQyxRQUFRLEVBQUUsTUFBTSxDQUFDLENBQUE7SUFHeEMsTUFBTSxHQUFHLENBQUMsV0FBVyxDQUFDLE1BQU0sRUFBRSxVQUFTLEdBQU8sRUFBRSxJQUFRO1FBQ3RELElBQUksR0FBRyxFQUFFO1lBQ1AsT0FBTyxDQUFDLEdBQUcsQ0FBQyxPQUFPLEVBQUUsR0FBRyxDQUFDLENBQUM7U0FDM0I7YUFBTTtZQUNMLE9BQU8sQ0FBQyxHQUFHLENBQUMsU0FBUyxFQUFFLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQztTQUN4QztJQUNILENBQUMsQ0FBQyxDQUFDLE9BQU8sRUFBRSxDQUFDO0lBR2IsMENBQTBDO0lBQzFDLE9BQU8sRUFBQyxRQUFRLEVBQUUsU0FBUyxFQUFDLENBQUM7QUFDL0IsQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IHt9O1xuY29uc3QgQVdTWFJheSA9IHJlcXVpcmUoJ2F3cy14cmF5LXNkaycpO1xuY29uc3QgQVdTID0gQVdTWFJheS5jYXB0dXJlQVdTKHJlcXVpcmUoJ2F3cy1zZGsnKSk7XG5cbmV4cG9ydHMuaGFuZGxlciA9IGFzeW5jIGZ1bmN0aW9uKGV2ZW50OmFueSkge1xuICBjb25zdCBzZWdtZW50ID0gQVdTWFJheS5nZXRTZWdtZW50KCk7IC8vcmV0dXJucyB0aGUgZmFjYWRlIHNlZ21lbnRcbiAgY29uc3Qgc3FzU2VnbWVudCA9IHNlZ21lbnQuYWRkTmV3U3Vic2VnbWVudCgnU1FTIExvZ2ljJyk7XG4gIGNvbnNvbGUubG9nKFwicmVxdWVzdDpcIiwgSlNPTi5zdHJpbmdpZnkoZXZlbnQsIHVuZGVmaW5lZCwgMikpO1xuXG4gIC8vIENyZWF0ZSBhbiBTUVMgc2VydmljZSBvYmplY3RcbiAgdmFyIHNxcyA9IG5ldyBBV1MuU1FTKHthcGlWZXJzaW9uOiAnMjAxMi0xMS0wNSd9KTtcbiAgbGV0IHBhdGggPSBldmVudC5SZWNvcmRzWzBdLlNucy5NZXNzYWdlO1xuXG4gIHZhciBwYXJhbXMgPSB7XG4gICAgRGVsYXlTZWNvbmRzOiAxLFxuICAgIE1lc3NhZ2VCb2R5OiBcImhlbGxvIGZyb20gXCIrcGF0aCxcbiAgICBRdWV1ZVVybDogcHJvY2Vzcy5lbnYuU1FTX1VSTCxcbiAgfTtcbiAgc3FzU2VnbWVudC5hZGRBbm5vdGF0aW9uKFwibWVzc2FnZVwiLCBwYXJhbXMuTWVzc2FnZUJvZHkpO1xuICBzcXNTZWdtZW50LmFkZE1ldGFkYXRhKFwicGFyYW1zXCIsIHBhcmFtcylcblxuXG4gIGF3YWl0IHNxcy5zZW5kTWVzc2FnZShwYXJhbXMsIGZ1bmN0aW9uKGVycjphbnksIGRhdGE6YW55KSB7XG4gICAgaWYgKGVycikge1xuICAgICAgY29uc29sZS5sb2coXCJFcnJvclwiLCBlcnIpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zb2xlLmxvZyhcIlN1Y2Nlc3NcIiwgZGF0YS5NZXNzYWdlSWQpO1xuICAgIH1cbiAgfSkucHJvbWlzZSgpO1xuXG4gIFxuICAvLyByZXR1cm4gcmVzcG9uc2UgYmFjayB0byB1cHN0cmVhbSBjYWxsZXJcbiAgcmV0dXJuIHtcInN0YXR1c1wiOiBcInN1Y2Nlc3NcIn07XG59O1xuIl19